$(document).ready(function () { // getCapacitaciones() $("#btnBuscar").on("click", function () { var edad = $('#edad').val(); if (edad == null || edad == '') { alertError(btoa('Todos los campos son requeridos')); return } $('#MsjAJX').html('') getHijos(edad) return }); $(document).on("click", "#excel-btn", function () { loadReporteEcxel() }); }); function getHijos(edad = null, ) { $.post('ajaxGeneral.php?mode=getHijos', { edad: edad }) .done(function (data) { if (data.trim() !== '') { // data.replace("getFuncionario", 'ss') data = JSON.parse(data); if (data.error != undefined) { alertError(data.error) return } var tr = "" $(data).each(function () { fecha_ini = new Date(this.fecha_nacimiento).getFullYear(); fecha_fin = new Date().getFullYear(); edad_2 = fecha_fin - fecha_ini; tr += `<tr> <td name="funcionario">${this.nom_f} ${this.ape_f}</td> <td name="nombre">${this.nom_p} ${this.ape_p}</td> <td name="fecha_nacimiento">${this.fecha_nacimiento}</td> <td name="edad">${edad_2}</td> </tr>` }); $("#tblHijos tbody").html(tr) } }) } function loadReporteEcxel() { var edad = $("#edad").val(); if (edad != '' && edad != null) { newwindow = window.open("?view=reporte&mode=reportehijosexcel&edad=" + edad, "width=815,height=460") if (newwindow == null) { alert('Configure el navegador para que permita las ventanas emergentes en esta pagina'); } else { newwindow.creator = self } } };;;